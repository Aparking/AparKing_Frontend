"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3069],{3069:(F,b,d)=>{d.r(b),d.d(b,{Tab3PageModule:()=>w});var C=d(177),r=d(4341),o=d(5933),h=d(8986),e=d(4438),c=d(467),v=d(689),y=d(3508);let P=(()=>{var i;class u{constructor(n,t,s,a,l,p){this.restService=n,this.alertCtrl=t,this.toastController=s,this.loadingCtrl=a,this.persistenceService=l,this.router=p,this.userForm=new r.gE({username:new r.MJ("",[r.k0.required]),email:new r.MJ("",[r.k0.required,r.k0.email]),confirmPassword:new r.MJ("",[r.k0.required]),dni:new r.MJ("",[r.k0.required,this.validateDNI]),birth_date:new r.MJ("",[r.k0.required,this.minimumAgeValidator(18)]),countryCode:new r.MJ("",[r.k0.required,r.k0.minLength(1)]),phone:new r.MJ("",[r.k0.required,this.phoneNumberValidator()])})}ngOnInit(){var n=this;return(0,c.A)(function*(){yield n.restService.getUserData().then(t=>{n.user=t}).catch(t=>{n.showAlert("Error al cargar los datos del usuario")}),n.userForm.patchValue({username:n.user.username,email:n.user.email,dni:n.user.dni,birth_date:n.user.birth_date,countryCode:n.user.phone.substring(1,3),phone:n.user.phone.substring(3)})})()}showAlert(n){var t=this;return(0,c.A)(function*(){yield(yield t.alertCtrl.create({header:"Error",message:n,buttons:["OK"]})).present()})()}validateDNI(n){const t=n.value;if(!/^[0-9]{8}[TRWAGMYFPDXBNJZSQVHLCKE]$/i.test(t))return{dniInvalid:!0};const a=t.charAt(t.length-1).toUpperCase(),l=parseInt(t,10)%23;return a!=="TRWAGMYFPDXBNJZSQVHLCKE".charAt(l)?{dniInvalid:!0}:null}minimumAgeValidator(n){return t=>{if(r.k0.required(t))return null;const s=new Date(t.value),a=new Date;return s<=new Date(a.getFullYear()-n,a.getMonth(),a.getDate())?null:{minimumAge:!0}}}phoneNumberValidator(){return n=>/^\d{9}$/.test(n.value)?null:{phoneNumber:!0}}saveChanges(){var n=this;return(0,c.A)(function*(){const t=yield n.loadingCtrl.create({message:"Actualizando perfil"}),s=yield n.toastController.create({duration:2e3,position:"bottom",color:"dark",buttons:[{text:"Cerrar",role:"cancel"}]});t.present(),n.userForm.value.phone=`+${n.userForm.value.countryCode}${n.userForm.value.phone}`,n.restService.updateUser(n.userForm.value).then(function(){var a=(0,c.A)(function*(l){s.message="Informaci\xf3n del perfil actualizada correctamente",yield s.present(),t.dismiss()});return function(l){return a.apply(this,arguments)}}()).catch(function(){var a=(0,c.A)(function*(l){let p=l.error,g="";for(let f in p)g+=p[f].join(", ");s.message=g,yield s.present(),t.dismiss()});return function(l){return a.apply(this,arguments)}}())})()}deleteProfile(){var n=this;return(0,c.A)(function*(){var s;yield(yield n.alertCtrl.create({header:"Eliminar perfil",message:"\xbfEst\xe1s seguro de que deseas eliminar tu perfil?",buttons:[{text:"Cancelar",role:"cancel"},{text:"Eliminar",handler:(s=(0,c.A)(function*(){const a=yield n.loadingCtrl.create({message:"Eliminando perfil"}),l=yield n.toastController.create({duration:2e3,position:"bottom",color:"dark",buttons:[{text:"Cerrar",role:"cancel"}]}),p=n.persistenceService.getToken();if(n.persistenceService.resetValues(),!p)return l.message="Error al eliminar el perfil",yield l.present(),void a.dismiss();a.present(),n.restService.postDeleteAccount(p.token).then(function(){var g=(0,c.A)(function*(f){l.message="Perfil eliminado correctamente",yield l.present(),a.dismiss(),n.router.navigate([""])});return function(f){return g.apply(this,arguments)}}()).catch(function(){var g=(0,c.A)(function*(f){l.message="Error al eliminar el perfil",yield l.present(),a.dismiss()});return function(f){return g.apply(this,arguments)}}())}),function(){return s.apply(this,arguments)})}]})).present()})()}}return(i=u).\u0275fac=function(n){return new(n||i)(e.rXU(v.G),e.rXU(o.hG),e.rXU(o.K_),e.rXU(o.Xi),e.rXU(y.X),e.rXU(h.Ix))},i.\u0275cmp=e.VBU({type:i,selectors:[["app-profile"]],decls:40,vars:35,consts:[["slot","end"],[3,"click"],["name","save"],["color","danger",3,"click"],["name","trash"],[1,"body"],[3,"formGroup"],[1,"input-container"],["fill","outline","placeholder","Miguel Cervantes","label-placement","floating","label","Nombre","formControlName","username","type","text",3,"autocapitalize"],[1,"error-conatiner"],[3,"field","message","error"],["fill","outline","placeholder","example@mail.com","label-placement","floating","label","Email","formControlName","email","type","email"],["fill","outline","placeholder","Escriba su DNI","label-placement","floating","label","DNI","formControlName","dni","type","text"],["fill","outline","placeholder","Escriba su fecha de nacimeinto","label-placement","floating","label","Fecha de nacimiento","formControlName","birth_date","type","date"],[1,"row"],["fill","outline","placeholder","34","label-placement","floating","label","Prefijo","formControlName","countryCode","type","number",2,"width","100px"],["fill","outline","placeholder","123456789","label-placement","floating","label","N\xfamero de tel\xe9fono","formControlName","phone","type","number"]],template:function(n,t){1&n&&(e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e.EFF(3,"User Profile"),e.k0s(),e.j41(4,"ion-buttons",0)(5,"ion-button",1),e.bIt("click",function(){return t.saveChanges()}),e.nrm(6,"ion-icon",2),e.k0s(),e.j41(7,"ion-button",3),e.bIt("click",function(){return t.deleteProfile()}),e.nrm(8,"ion-icon",4),e.k0s()()()(),e.j41(9,"ion-content")(10,"div",5)(11,"form",6)(12,"div",7),e.nrm(13,"ion-input",8),e.j41(14,"div",9),e.nrm(15,"app-error-message",10),e.k0s()(),e.j41(16,"div",7),e.nrm(17,"ion-input",11),e.j41(18,"div",9),e.nrm(19,"app-error-message",10)(20,"app-error-message",10),e.k0s()(),e.j41(21,"div",7),e.nrm(22,"ion-input",12),e.j41(23,"div",9),e.nrm(24,"app-error-message",10)(25,"app-error-message",10),e.k0s()(),e.j41(26,"div",7),e.nrm(27,"ion-input",13),e.j41(28,"div",9),e.nrm(29,"app-error-message",10)(30,"app-error-message",10),e.k0s()(),e.j41(31,"div",7)(32,"div",14),e.nrm(33,"ion-input",15)(34,"ion-input",16),e.k0s(),e.j41(35,"div",9),e.nrm(36,"app-error-message",10)(37,"app-error-message",10)(38,"app-error-message",10)(39,"app-error-message",10),e.k0s()()()()()),2&n&&(e.R7$(11),e.Y8G("formGroup",t.userForm),e.R7$(2),e.Y8G("autocapitalize",!0),e.R7$(2),e.Y8G("field",t.userForm.get("username"))("message","Debe introducir su nombre")("error","required"),e.R7$(4),e.Y8G("field",t.userForm.get("email"))("message","El email es obligatorio")("error","required"),e.R7$(),e.Y8G("field",t.userForm.get("email"))("message","El email no es v\xe1lido")("error","email"),e.R7$(4),e.Y8G("field",t.userForm.get("dni"))("message","El dni es obligatorio")("error","required"),e.R7$(),e.Y8G("field",t.userForm.get("dni"))("message","El dni no es v\xe1lido")("error","dniInvalid"),e.R7$(4),e.Y8G("field",t.userForm.get("birth_date"))("message","La fecha de nacimiento es obligatoria")("error","required"),e.R7$(),e.Y8G("field",t.userForm.get("birth_date"))("message","Debe tener m\xednimo 18 a\xf1os")("error","minimumAge"),e.R7$(6),e.Y8G("field",t.userForm.get("phone"))("message","Debe introducir su n\xfamero de tel\xe9fono")("error","required"),e.R7$(),e.Y8G("field",t.userForm.get("phone"))("message","N\xfamero inv\xe1lido")("error","phoneNumber"),e.R7$(),e.Y8G("field",t.userForm.get("countryCode"))("message","Debe introducir su prefijo")("error","required"),e.R7$(),e.Y8G("field",t.userForm.get("countryCode"))("message","Prefijo inv\xe1lido")("error","minLength"))},dependencies:[o.Jm,o.QW,o.W9,o.eU,o.iq,o.$w,o.BC,o.ai,o.su,o.Gw,r.qT,r.BC,r.cb,r.j4,r.JD],styles:[".appbar[_ngcontent-%COMP%]{font-weight:700;font-family:Lobster,sans-serif}.invalid-field[_ngcontent-%COMP%]{border-color:red}.box[_ngcontent-%COMP%]{border:2px solid #d6d6d6;width:90%;height:60px;padding:10px}.body[_ngcontent-%COMP%]{margin:0;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;padding:0;text-align:center;width:100%;height:60%}.body[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-weight:700;text-align:start;font-size:20px;margin-bottom:5px}.body[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{height:300px;width:600px;margin:0;padding:0}.body[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;justify-content:center;align-items:flex-start;margin-top:5px}.body[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{padding:5px;width:90%}ion-content[_ngcontent-%COMP%]{justify-content:center;margin:20px 0 0;align-items:center;display:flex;flex-direction:column;padding:20px;text-align:center;width:100%;height:100%}ion-content[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-weight:700;font-size:x-large;font-family:Times New Roman,Times,serif}form[_ngcontent-%COMP%]{display:flex;width:100%;align-items:center;align-content:center;justify-content:center;text-align:center;flex-direction:column;margin:0}form[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;align-items:center;padding:10px;margin:0 20px}form[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{width:90%;padding:20px;text-align:start;--padding-end: 10px;--padding-start: 10px;border:2px solid #d6d6d6}form[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{padding-left:5px;padding-right:5px;padding-top:20px;width:90%;height:50px;margin-bottom:10%}.row[_ngcontent-%COMP%]{display:flex;flex-direction:row;width:100%;margin:0 20px;padding:0 5%}.error-conatiner[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;align-items:flex-start;padding-left:5%}.input-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:90%;margin:10px auto}.checkbox-container[_ngcontent-%COMP%]{flex-direction:row;align-items:center;margin-bottom:10px}ion-checkbox[_ngcontent-%COMP%]{margin-right:10px}.error-container[_ngcontent-%COMP%]{width:90%;padding-left:10px}"]}),u})();const x=[{path:"",component:(()=>{var i;class u{constructor(){}}return(i=u).\u0275fac=function(n){return new(n||i)},i.\u0275cmp=e.VBU({type:i,selectors:[["app-tab3"]],decls:6,vars:2,consts:[[3,"translucent"],[3,"fullscreen"]],template:function(n,t){1&n&&(e.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),e.EFF(3," Listado de cesiones de parking "),e.k0s()()(),e.j41(4,"ion-content",1),e.nrm(5,"app-profile"),e.k0s()),2&n&&(e.Y8G("translucent",!0),e.R7$(4),e.Y8G("fullscreen",!0))},dependencies:[o.W9,o.eU,o.BC,o.ai,P]}),u})()}];let M=(()=>{var i;class u{}return(i=u).\u0275fac=function(n){return new(n||i)},i.\u0275mod=e.$C({type:i}),i.\u0275inj=e.G2t({imports:[h.iI.forChild(x),h.iI]}),u})(),w=(()=>{var i;class u{}return(i=u).\u0275fac=function(n){return new(n||i)},i.\u0275mod=e.$C({type:i}),i.\u0275inj=e.G2t({imports:[o.bv,C.MD,r.YN,M,r.X1]}),u})()}}]);