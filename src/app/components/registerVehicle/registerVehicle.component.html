<ion-header>
  <ion-toolbar style="--background: transparent; --border-color: transparent;">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/"></ion-back-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-card>
    <ion-card-header>
      <ion-toolbar>
        <ion-buttons slot="start">
          <ion-back-button defaultHref="/G11/aparKing/tab3"></ion-back-button>
        </ion-buttons>
        <ion-card-title>Registrar vehículo</ion-card-title>
      </ion-toolbar>
    </ion-card-header>
    <form [formGroup]="registerForm" (submit)="registerSubmit()">
      <ion-card-content>
        <ion-item class="input-item">
          <ion-label position="floating">Matrícula</ion-label>
          <ion-input placeholder="1234 ABC" formControlName="carModel" type="text" [autocapitalize]="true"></ion-input>
        </ion-item>
        <div class="error">
          <app-error-message [field]="registerForm.get('carModel')"
            [message]="'Debe introducir la matricula del vehiculo'" [error]="'required'"></app-error-message>
        </div>
        <ion-item class="input-item">
          <ion-label position="floating">Color</ion-label>
          <ion-select formControlName="color">
            <ion-select-option value="rojo">Rojo</ion-select-option>
            <ion-select-option value="verde">Verde</ion-select-option>
            <ion-select-option value="azul">Azul</ion-select-option>
            <ion-select-option value="amarillo">Amarillo</ion-select-option>
            <ion-select-option value="naranja">Naranja</ion-select-option>
            <ion-select-option value="violeta">Violeta</ion-select-option>
            <ion-select-option value="rosa">Rosa</ion-select-option>
            <ion-select-option value="blanco">Blanco</ion-select-option>
            <ion-select-option value="negro">Negro</ion-select-option>
            <ion-select-option value="gris">Gris</ion-select-option>
          </ion-select>
        </ion-item>
        <div class="error">
          <app-error-message [field]="registerForm.get('color')" [message]="'El color es obligatorio'"
            [error]="'required'"></app-error-message>
        </div>
        <ion-item class="input-item">
          <ion-label position="floating">Altura</ion-label>
          <ion-input placeholder="En metros" formControlName="height" type="number" step="0.01"></ion-input>
        </ion-item>
        <div class="error">
          <app-error-message [field]="registerForm.get('height')" [message]="'La altura del coche es obligatoria'"
            [error]="'required'"></app-error-message>
        </div>
        <ion-item class="input-item">
          <ion-label position="floating">Anchura</ion-label>
          <ion-input placeholder="En metros" formControlName="width" type="number" step="0.01"></ion-input>
        </ion-item>
        <div class="error">
          <app-error-message [field]="registerForm.get('width')" [message]="'La anchura del coche es obligatoria'"
            [error]="'required'"></app-error-message>
        </div>
        <ion-item>
          <ion-label position="floating">Longitud</ion-label>
          <ion-input placeholder="En metros" formControlName="length" type="number" step="0.01"></ion-input>
        </ion-item>
        <div class="error">
          <app-error-message [field]="registerForm.get('length')" [message]="'El largo del coche es obligatorio'"
            [error]="'required'"></app-error-message>
        </div>
        <div class="error">
          <app-error-message [field]="registerForm.get('length')" [message]="'El largo no puede ser negativo'"
            [error]="'min'"></app-error-message>
        </div>
        <ion-button expand="full" type="submit" [disabled]="!registerForm.valid" shape="round" color="success">
          Registrar
        </ion-button>
      </ion-card-content>
    </form>
  </ion-card>

  <ion-list>
    <ion-card *ngFor="let item of vehicle; let i = index">
      <ion-card-header>
        <ion-card-title>Matricula: {{item.carModel}}</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        Color: {{item.color}}<br>
        Tamaño: {{item.height}} metros<br>
        Ancho: {{item.width}} metros<br>
        Longitud: {{item.length}} metros<br>
        <div *ngIf="item.principalCar === true"
          style="margin-top: 10px; text-align: center; font-size: 1.2em; color: goldenrod; font-weight: bold;">PRINCIPAL
        </div>
        <ion-card-content>
          <div style="display: flex; justify-content: center;">
            <ion-button *ngIf="item.principalCar !== true" slot="end" [disabled]="item.principalCar"
              style="background-color: transparent; --background: transparent;" color="success" shape="round"
              (click)="item.id ? updateVehiculoPrincipal(item.id) : null">
              <ion-icon name="car"></ion-icon>
            </ion-button>
          </div>
        </ion-card-content>
      </ion-card-content>
    </ion-card>
  </ion-list>
</ion-content>